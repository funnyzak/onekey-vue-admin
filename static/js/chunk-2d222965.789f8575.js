(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d222965"],{cef3:function(t,a,e){"use strict";e.r(a);var l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"app-container"},[e("el-tabs",{attrs:{type:"card"},on:{"tab-click":t.handleClick},model:{value:t.activeName,callback:function(a){t.activeName=a},expression:"activeName"}},[e("el-tab-pane",{attrs:{label:"概况",name:"main"}},[[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.main,stripe:""}},[e("el-table-column",{attrs:{prop:"key",label:"属性",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{prop:"value",label:"值"}})],1)]],2),t._v(" "),e("el-tab-pane",{attrs:{label:"数据源",name:"datasource"}},[e("el-tabs",{attrs:{type:"card",addable:""},on:{"tab-click":t.switchDataSource},model:{value:t.activeDataSource,callback:function(a){t.activeDataSource=a},expression:"activeDataSource"}},t._l(t.datasource,(function(a){return e("el-tab-pane",{key:a.id,attrs:{label:a.name,name:a.id}},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:a.content,stripe:""}},[e("el-table-column",{attrs:{prop:"key",label:"属性",width:"240"}}),t._v(" "),e("el-table-column",{attrs:{prop:"value",label:"值"}})],1)],1)})),1)],1),t._v(" "),e("el-tab-pane",{attrs:{label:"Sql监控",name:"sql"}},[[e("el-select",{staticStyle:{"margin-bottom":"10px"},attrs:{placeholder:"请选择"},model:{value:t.refresh,callback:function(a){t.refresh=a},expression:"refresh"}},t._l(t.options,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],t._v(" "),[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.sql,stripe:""}},[e("el-table-column",{attrs:{sortable:"",prop:"ID",label:"ID",width:"125"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"SQL",label:"SQL","show-overflow-tooltip":"",width:"425"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"ExecuteCount",label:"执行数",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"TotalTime",label:"执行时间",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"MaxTimespan",label:"最慢",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"InTransactionCount",label:"事务中",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"ErrorCount",label:"错误数",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"EffectedRowCount",label:"更新行数",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"FetchRowCount",label:"读取行数",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"RunningCount",label:"执行中",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{sortable:"",prop:"ConcurrentMax",label:"最大并发",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{formatter:t.arrayFormatter,sortable:"",prop:"Histogram",label:"执行时间分布",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{formatter:t.arrayFormatter,sortable:"",prop:"ExecuteAndResultHoldTimeHistogram",label:"执行+RS时分布",width:"220"}}),t._v(" "),e("el-table-column",{attrs:{formatter:t.arrayFormatter,sortable:"",prop:"FetchRowCountHistogram",label:"读取行分布",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{formatter:t.arrayFormatter,sortable:"",prop:"EffectedRowCountHistogram",label:"更新行分布",width:"180"}}),t._v(" "),e("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{type:"text",size:"small"},nativeOn:{click:function(e){return e.preventDefault(),t.showSqlDetail(a.row.ID)}}},[t._v("\n                详情\n              ")])]}}])})],1),t._v(" "),e("el-dialog",{attrs:{visible:t.showSqlDetails,"close-on-click-modal":!1,"close-on-press-escape":!1,title:"Sql详情"},on:{"update:visible":function(a){t.showSqlDetails=a}}},[e("el-row",[e("el-col",{attrs:{span:24}},[e("h3",[t._v("格式化Sql")])])],1),t._v(" "),e("el-input",{attrs:{autosize:{minRows:2,maxRows:4},type:"textarea",placeholder:"请输入内容"},model:{value:t.showingSql.formattedSql,callback:function(a){t.$set(t.showingSql,"formattedSql",a)},expression:"showingSql.formattedSql"}})],1)]],2)],1)],1)},o=[],r=(e("7f7f"),e("bc3a")),n=e.n(r),s={name:"Database",data:function(){return{timer:0,refresh:5,options:[{value:5,label:"5秒"},{value:10,label:"10秒"},{value:9999999999,label:"不刷新"}],activeName:"main",main:[],activeDataSource:"1",datasource:[],sql:[],wall:[],showSqlDetails:!1,showingSqlId:0,showingSql:{}}},watch:{refresh:function(t){clearInterval(this.timer),this.timer=setInterval(this.loadSqls,1e3*t)}},destroyed:function(){clearInterval(this.timer)},created:function(){var t=this;n.a.get("/console/druid/basic.json").then((function(a){t.main=t.map2List(a.data.Content)})).catch((function(t){console.log(t)}))},methods:{arrayFormatter:function(t,a){return"["+t[a.property].join(",")+"]"},showingSqlDetail:function(t){var a=this;n.a.get("/console/druid/sql-"+t+".json").then((function(t){a.showingSql=t.data.Content}),this.globalFail)},showSqlDetail:function(t){this.showSqlDetails=!0,this.showingSqlId=t,this.showingSqlDetail(t)},map2List:function(t){var a=[];for(var e in t)a.push({key:e+"",value:t[e]+""});return a},switchDataSource:function(){},loadDataSource:function(){var t=this;n.a.get("/console/druid/datasource.json").then((function(a){t.activeDataSource=a.data.Content[0].Identity+"",t.datasource=[];for(var e=0;e<a.data.Content.length;e++){var l=a.data.Content[e];t.datasource.push({name:l.Name,id:l.Identity+"",content:t.map2List(l)})}}),(function(a){t.globalFail(a)}))},loadSqls:function(){var t=this;n.a.get("/console/druid/sql.json").then((function(a){t.sql=a.data.Content}),(function(a){t.globalFail(a)}))},loadWall:function(){},handleClick:function(t,a){switch(t.name){case"datasource":this.loadDataSource();break;case"sql":this.loadSqls();break;case"wall":this.loadWall();break;default:break}}}},i=s,c=e("2877"),u=Object(c["a"])(i,l,o,!1,null,null,null);a["default"]=u.exports}}]);